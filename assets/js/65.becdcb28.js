(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{293:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("Storefront API modules are a great way to add custom GraphQL schemas, REST API endpoints or customize the ElasticSearch mappings. The easiest way to create a new module is to use the [https://github.com/DivanteLtd/storefront-api/tree/develop/src/modules/template-module] as a boilerplate.")]),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://github.com/DivanteLtd/storefront-api",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("storefront-api")]),a("OutboundLink")],1),t._v(" is a "),a("code",[t._v("Template")]),t._v(". That means you can use the "),a("code",[t._v("Use template")]),t._v(" feature to create a new repository for customizing the API:")]),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("Then you need to name your repository properly:")]),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("You can find "),a("a",{attrs:{href:"https://github.com/pkarw/storefront-api-example",target:"_blank",rel:"noopener noreferrer"}},[t._v("my demo repository here"),a("OutboundLink")],1),t._v(". "),a("strong",[t._v("Note:")]),t._v(" It's based on SFAPI 1.0RC1. With SFAPI 1.0RC2, we've introduced the "),a("code",[t._v("packages/")]),t._v(" monorepo containing some of the core modules previously available in the "),a("code",[t._v("src/modules")]),t._v(".")]),t._v(" "),t._m(4),t._v(" "),a("p",[t._v("The installation process is pretty straightforward. You start by cloning your brand new repo:")]),t._v(" "),t._m(5),a("p",[t._v("Then, install the dependencies:")]),t._v(" "),t._m(6),a("p",[t._v("OK, now we can run the whole thing and import some sample data:")]),t._v(" "),t._m(7),a("p",[t._v("The last step before we really get into developing the module is to restore some demo data:")]),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),a("p",[t._v("We'll use the template by simply copying it:")]),t._v(" "),t._m(12),t._m(13),t._v(" "),a("p",[t._v("Our goal is to add a custom GraphQL query to add two numbers and a REST API, which returns the provided query parameter. Yeah. I know. Sounds silly üòÉ Let's try it out!")]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._m(16),t._v(" "),a("p",[a("strong",[t._v("Note:")]),t._v(" The "),a("code",[t._v("registerExtensions")]),t._v(" call is 100% optional. It provides you with a way to have dynamic extension points. All the handlers defined in a folder you've provided to this function call (in our example it will be: "),a("code",[t._v("src/modules/custom-api/api*")]),t._v(") will be loaded and mounted to the "),a("code",[t._v("api")]),t._v(" router section. "),a("a",{attrs:{href:"https://github.com/DivanteLtd/storefront-api/blob/develop/src/modules/default-catalog/api/extensions/elastic-stock/index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("See example"),a("OutboundLink")],1),t._v(")")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._m(22),t._v(" "),a("p",[t._v("This error means we need to modify the GraphQL schema to avoid conflicts with the default template module (the ancestor).")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._m(26),t._v(" "),t._m(27),t._m(28),t._v(" "),t._m(29),a("p",[t._v("Wow! That was easy!")]),t._v(" "),t._m(30),t._v(" "),a("p",[t._v("After the changes made in Step 6, our API should gracefully compile and you should see the following messages in the console:")]),t._v(" "),t._m(31),a("p",[a("strong",[t._v("Note:")]),t._v(" You may use the "),a("code",[t._v("yarn lint-gql")]),t._v(" command to execute the "),a("a",{attrs:{href:"https://github.com/cjoudrey/graphql-schema-linter",target:"_blank",rel:"noopener noreferrer"}},[t._v("graphql-schema-linter"),a("OutboundLink")],1),t._v(" over all GraphQL schemas used in the project. It's a pretty useful tool for working with graphql.")]),t._v(" "),a("p",[t._v("Let's check GraphQL first! Open http://localhost:8080/graphql to access the GraphQL Playground.")]),t._v(" "),t._m(32),t._v(" "),a("p",[t._v("Looks awesome! Congratulations!")]),t._v(" "),t._m(33),t._v(" "),t._m(34),a("p",[t._v("Wow! That looks just awesome üòÉ")])])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"creating-a-new-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-new-module"}},[this._v("#")]),this._v(" Creating a new module")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_1-create-a-repository"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-create-a-repository"}},[this._v("#")]),this._v(" 1. Create a repository")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://divante.com/github/storefront-api/tutorial/step_1_use_template.png",alt:"Use template"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://divante.com//github/storefront-api/tutorial/step_2_prepare_repo.png",alt:"Prepare your repository"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-setup-storefront-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-setup-storefront-api"}},[this._v("#")]),this._v(" 2. Setup Storefront API")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pkarwatka$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/pkarw/storefront-api-example.git\nCloning into "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'storefront-api-example'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nremote: Enumerating objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("309")]),t._v(", done.\nremote: Counting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("309")]),t._v("/309"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\nremote: Compressing objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("278")]),t._v("/278"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\nremote: Total "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("309")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", pack-reused "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nReceiving objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("309")]),t._v("/309"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.42")]),t._v(" MiB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("882.00")]),t._v(" KiB/s, done.\nResolving deltas: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v("/35"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\nChecking connectivity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". done.\npkarwatka$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" storefront-api-example/\npkarwatka$\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pkarwatka$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" v1.17.3\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" üîç  Resolving packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" üöö  Fetching packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" üîó  Linking dependencies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("/4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" üî®  Building fresh packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n‚ú®  Done "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(".57s.\npkarwatka$\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pkarwatka$ docker-compose up\nRecreating elasticsearch "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nRecreating elasticsearch "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\nRecreating sfa_app_1     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# a lot of random log messages ;)")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension mailchimp-subscribe registered under /ext/mailchimp-subscribe base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" info: Winston logging library initialized.\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension example-magento-api registered under /ext/example-magento-api base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension cms-data registered under /ext/cms-data base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension mail-service registered under /ext/mail-service base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension example-processor registered under /ext/example-processor base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension elastic-stock registered under /ext/elastic-stock base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" API Modules registration finished. "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" succesfulyRegistered: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5 / 5'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   registrationOrder:\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default-vsf'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initMiddleware: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initMiddleware"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vsf-default'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        loadMappings: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: loadMappings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initGraphql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initGraphql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default-img'")]),t._v(", initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sample-api'")]),t._v(", initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'template-module'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initGraphql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initGraphql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        loadMappings: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: loadMappings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Storefront GraphQL API started at http://0.0.0.0:8080\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pkarwatka$ docker "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" -it sfa_app_1 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" restore7\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" run v1.13.0\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TS_NODE_PROJECT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tsconfig.json"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" ts-node -r tsconfig-paths/register scripts/elastic7.ts restore --output-index"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("vue_storefront_catalog "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run db7 rebuild --indexName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("vue_storefront_catalog\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# way more super cool log messages ...")]),t._v("\n** Removing the original index\nIndex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" created\n** Creating "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("\nPublic index "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" does not exists index_not_found_exception\n** Creating "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("\nPublic index "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" does not exists index_not_found_exception\nIndex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" created\nIndex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" created\n** Removing the original index\n** Creating "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("\nPublic index "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" does not exists index_not_found_exception\nIndex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" created\n** Removing the original index\n** Creating "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("\nPublic index "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" does not exists index_not_found_exception\nIndex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" created\n** Removing the original index\n** Creating "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("\nPublic index "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" does not exists index_not_found_exception\nIndex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v(" created\nDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("62")]),t._v(".18s.\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-use-the-template"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-use-the-template"}},[this._v("#")]),this._v(" 3. Use the template")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The easiest way to extend Storefront API is to use the "),s("code",[this._v("template-module")]),this._v(":")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pkarwatka$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" src/modules/\npkarwatka$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -l\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" pkarwatka  staff  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("399")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":24 index.ts\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" pkarwatka  staff  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":24 sample-api\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" pkarwatka  staff  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":24 template-module\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("pkarwatka$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("cp")]),this._v(" -R template-module/ my-custom-module\npkarwatka$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("ls")]),this._v(" my-custom-module/\napi\t\telasticsearch\tgraphql\t\tindex.ts\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_4-modify-the-module-entry-point"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-modify-the-module-entry-point"}},[this._v("#")]),this._v(" 4. Modify the module entry point")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("First, we need to edit "),a("code",[t._v("src/modules/my-custom-module/index.ts")]),t._v(" to apply the proper module name - we'll change the "),a("code",[t._v("key")]),t._v(", which should be unique, and change the "),a("code",[t._v("TemplateModule")]),t._v(" object name to "),a("code",[t._v("CustomModule")]),t._v(". We'll also simplify the interface - we'll remove "),a("code",[t._v("loadMappings")]),t._v(" as we don't plan to extend the ElasticSearch mappings.")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" StorefrontApiModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" registerExtensions "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@storefront-api/lib/module'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" StorefrontApiContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" GraphqlConfiguration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ElasticSearchMappings "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@storefront-api/lib/module/types'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Router "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" resolvers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./graphql/resolvers'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" schema "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./graphql/schema'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" version "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./api/version'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" loadSchema "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@storefront-api/lib/elastic'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" CustomModule"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StorefrontApiModule "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StorefrontApiModule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'custom-module'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  initGraphql"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StorefrontApiContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("GraphqlConfiguration")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      resolvers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      schema"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      hasGraphqlSupport"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  initApi"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StorefrontApiContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" api "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Router")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mount the order resource")]),t._v("\n    api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/sayHello'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// api router")]),t._v("\n    app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/custom'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Of course, you might want to define the API handlers in separate files and import them to use with "),s("code",[this._v("api.use")]),this._v(" or "),s("code",[this._v("app.use")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_5-enable-your-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-enable-your-module"}},[this._v("#")]),this._v(" 5. Enable your module")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The next step is to load your module in the "),s("code",[this._v("src/modules/index.ts")]),this._v(" entry point:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" DefaultVuestorefrontApiModule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./default-vsf'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" DefaultCatalogModule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./default-catalog'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" DefaultImgModule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./default-img'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" SampleApiModule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./sample-api'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" TemplateModule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./template-module'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" CustomModule "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./my-custom-module'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  DefaultVuestorefrontApiModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  DefaultCatalogModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  DefaultImgModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SampleApiModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  TemplateModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  CustomModule\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Two lines after, just after saving the file, if you take a look at the console output of the "),s("code",[this._v("docker-compose up")]),this._v(" command, you'll see the following error messages:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" app crashed - waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" changes before starting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" files triggering change check: src/modules/my-custom-module/index.ts\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" matched rule: /var/www/src/**/*\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" changes after filters "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("before/after"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" restarting due to changes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" src/modules/my-custom-module/index.ts\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" starting "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" lint-gql "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" ts-node src"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" spawning\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" child pid: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("323")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" $ graphql-schema-linter src/**/*.graphqls\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" /var/www/src/modules/my-custom-module/graphql/hello/schema.graphqls\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(":5 Field "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Query.sayHello"')]),t._v(" can only be defined once.    invalid-graphql-schema\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":5 Field "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Query.testElastic"')]),t._v(" can only be defined once. invalid-graphql-schema\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ‚úñ "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" errors detected\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" error Command failed with "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" code "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" info Visit https://yarnpkg.com/en/docs/cli/run "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" documentation about this command.\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" app crashed - waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" changes before starting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("strong",[t._v("Note:")]),t._v(" The default "),a("code",[t._v("docker-compose up")]),t._v(" command runs Storefront API in "),a("code",[t._v("development")]),t._v(" mode with the "),a("code",[t._v("nodemon")]),t._v(" based dynamic recompile process. Each time you modify the "),a("code",[t._v("*.ts *.js")]),t._v(" or "),a("code",[t._v("*.graphqls")]),t._v(" files, the app gets recompiled, and changes applied.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_6-modify-the-graphql-schema"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-modify-the-graphql-schema"}},[this._v("#")]),this._v(" 6. Modify the GraphQL schema")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("To modify the GraphQL Schema, we'll just modify the content of "),s("code",[this._v("src/modules/my-custom-module/graphql")]),this._v(". First, by renaming the "),s("code",[this._v("hello")]),this._v(" to "),s("code",[this._v("numbers")]),this._v(":")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pkarwatka$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" hello/\nresolver.js      schema.graphqls\npkarwatka$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" hello/ numbers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -l\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" pkarwatka  staff  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":33 numbers\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" pkarwatka  staff  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("251")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":33 resolvers.js\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" pkarwatka  staff  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("245")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":33 schema.js\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The next step is to modify "),s("code",[this._v("numbers/schema.graphqls")]),this._v(":")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-graphqls extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("extend type Query {\n    # This is an example call to add numbers\n    add (\n        firstNumber: Int,\n        secondNumber: Int\n    ): Int\n}\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Then we need to implement "),s("code",[this._v("numbers/resolvers.js")]),this._v(":")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  Query"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" firstNumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" secondNumber "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rootValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" firstNumber "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" secondNumber\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_7-test-the-graphql-and-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-test-the-graphql-and-api"}},[this._v("#")]),this._v(" 7. Test the GraphQL and API")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ graphql-schema-linter src/**/*.graphqls\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ‚úî "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" errors detected\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" failed reading "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" /var/www/config/certs/.gitkeep: Could not parse certificate\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension mailchimp-subscribe registered under /ext/mailchimp-subscribe base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" info: Winston logging library initialized.\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension example-magento-api registered under /ext/example-magento-api base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension cms-data registered under /ext/cms-data base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension mail-service registered under /ext/mail-service base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension example-processor registered under /ext/example-processor base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extension elastic-stock registered under /ext/elastic-stock base URL\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" API Modules registration finished. "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" succesfulyRegistered: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5 / 5'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   registrationOrder:\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default-vsf'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initMiddleware: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initMiddleware"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vsf-default'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        loadMappings: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: loadMappings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initGraphql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initGraphql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default-img'")]),t._v(", initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sample-api'")]),t._v(", initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" key: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'template-module'")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initGraphql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initGraphql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        loadMappings: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: loadMappings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        initApi: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Function: initApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\napp_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Storefront GraphQL API started at http://0.0.0.0:8080\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://divante.com/github/storefront-api/tutorial/step_3_query_result.png",alt:"GraphQL playground with the simple query"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Let's check if the API extension works, as well as the GraphQL features we added. As you might remember, we appended a GET request handler under "),s("code",[this._v("/custom/sayHello")]),this._v(". Let's try it out:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("pkarwatka$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("curl")]),this._v(" http://localhost:8080/custom/sayHello?name"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("Piotr\nHello Piotr"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("!")]),this._v("\n")])])])}],!1,null,null,null);s.default=n.exports}}]);